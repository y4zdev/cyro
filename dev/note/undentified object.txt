check middleware route and make sure `finishState()` is in response handler

dont change responsehandler functions without checking middleware